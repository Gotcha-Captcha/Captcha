<!DOCTYPE html>
<html class="dark" lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="theme-color" content="#0a0c12" />
    <title>AI ReCaptcha Solver Dashboard</title>
    
    <!-- External Dependencies -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet" />
    
    <!-- Tailwind Config -->
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#135bec",
                        "accent-green": "#00ff41",
                        "background-light": "#f6f6f8",
                        "background-dark": "#0a0c12",
                        "surface-dark": "#161b26",
                        "border-dark": "#282e39",
                    },
                    fontFamily: {
                        "display": ["Space Grotesk"]
                    },
                    borderRadius: { "DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px" },
                },
            },
        }
    </script>
    
    <!-- Custom Styles -->
    <link href="/static/css/main.css" rel="stylesheet" />
</head>

<body class="bg-background-light dark:bg-background-dark text-white min-h-screen flex flex-col overflow-hidden">
    <!-- Mobile Sidebar Overlay -->
    <div id="sidebar-overlay" class="sidebar-overlay fixed inset-0 bg-black/60 z-40 md:hidden" onclick="toggleSidebar()"></div>

    <!-- TopNavBar -->
    <header class="flex items-center justify-between whitespace-nowrap border-b border-solid border-border-dark bg-background-dark px-4 sm:px-6 md:px-10 py-3 z-30 safe-top">
        <div class="flex items-center gap-2 sm:gap-4 text-white">
            <!-- Mobile Menu Button -->
            <button id="menu-toggle" class="flex md:hidden items-center justify-center rounded-lg h-10 w-10 bg-surface-dark border border-border-dark text-white touch-active" onclick="toggleSidebar()">
                <span class="material-symbols-outlined text-lg">menu</span>
            </button>
            <div class="size-5 sm:size-6 text-primary">
                <svg fill="none" viewbox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
                    <path d="M44 11.2727C44 14.0109 39.8386 16.3957 33.69 17.6364C39.8386 18.877 44 21.2618 44 24C44 26.7382 39.8386 29.123 33.69 30.3636C39.8386 31.6043 44 33.9891 44 36.7273C44 40.7439 35.0457 44 24 44C12.9543 44 4 40.7439 4 36.7273C4 33.9891 8.16144 31.6043 14.31 30.3636C8.16144 29.123 4 26.7382 4 24C4 21.2618 8.16144 18.877 14.31 17.6364C8.16144 16.3957 4 14.0109 4 11.2727C4 7.25611 12.9543 4 24 4C35.0457 4 44 7.25611 44 11.2727Z" fill="currentColor"></path>
                </svg>
            </div>
            <h2 class="text-white text-base sm:text-lg font-bold leading-tight tracking-tight">Gotcha! <span class="text-primary">v2.0</span></h2>
            <span class="hidden sm:inline-block ml-2 sm:ml-4 px-2 py-0.5 rounded bg-accent-green/10 text-accent-green text-xs font-mono border border-accent-green/20">FastAPI: ONLINE</span>
        </div>
        <div class="flex flex-1 justify-end gap-2 sm:gap-8">
            <div class="flex gap-2 sm:gap-3">
                <button class="flex items-center justify-center rounded-lg h-10 w-10 bg-surface-dark border border-border-dark text-white hover:bg-border-dark transition-colors touch-active">
                    <span class="material-symbols-outlined text-lg">settings</span>
                </button>
            </div>
        </div>
    </header>

    <div class="flex flex-1 overflow-hidden">
        <!-- SideNavBar / Control Panel - Mobile Slide-in, Desktop Fixed -->
        <aside id="sidebar" class="mobile-sidebar fixed md:relative left-0 top-0 h-full w-72 sm:w-80 bg-surface-dark border-r border-border-dark flex flex-col justify-between p-4 sm:p-6 overflow-y-auto z-50 md:z-auto md:transform-none">
            <!-- Mobile Close Button -->
            <button class="md:hidden absolute top-4 right-4 text-white touch-active" onclick="toggleSidebar()">
                <span class="material-symbols-outlined">close</span>
            </button>
            <div class="flex flex-col gap-6 sm:gap-8 mt-8 md:mt-0">
                <div>
                    <h1 class="text-white text-xs font-bold uppercase tracking-widest mb-3 sm:mb-4 opacity-50">Model Metrics</h1>
                    <div class="space-y-2 sm:space-y-3">
                        <div class="p-3 sm:p-4 rounded-xl bg-background-dark border border-border-dark">
                            <div class="flex flex-col gap-1">
                                <p id="metric-accuracy-label" class="text-[#9da6b9] text-[10px] font-bold uppercase tracking-tight">Word Accuracy</p>
                                <span id="metric-accuracy" class="text-primary text-base sm:text-lg font-bold">{{ v1_metrics.accuracy }}</span>
                            </div>
                            <p id="metric-accuracy-desc" class="text-[10px] text-[#475569] mt-2 leading-tight">Entire 5-character sequence must be perfect. One wrong letter = 0% success.</p>
                        </div>
                        <div class="p-3 sm:p-4 rounded-xl bg-background-dark border border-border-dark">
                            <div class="flex flex-col gap-1">
                                <p id="metric-char-accuracy-label" class="text-[#9da6b9] text-[10px] font-bold uppercase tracking-tight">Character Accuracy</p>
                                <span id="metric-char-accuracy" class="text-accent-green text-base sm:text-lg font-bold">{{ v1_metrics.char_accuracy }}</span>
                            </div>
                            <p id="metric-char-accuracy-desc" class="text-[10px] text-[#475569] mt-2 leading-tight">Percentage of individual letters correctly recognized across all samples.</p>
                        </div>
                        <div class="grid grid-cols-3 gap-2 sm:gap-3">
                            <div class="p-2 sm:p-3 rounded-xl bg-background-dark border border-border-dark flex flex-col gap-1">
                                <p class="text-[#9da6b9] text-[8px] font-bold uppercase tracking-tight">Precision</p>
                                <span id="metric-precision" class="text-white text-xs sm:text-sm font-bold">{{ v1_metrics.precision }}</span>
                            </div>
                            <div class="p-2 sm:p-3 rounded-xl bg-background-dark border border-border-dark flex flex-col gap-1">
                                <p class="text-[#9da6b9] text-[8px] font-bold uppercase tracking-tight">Recall</p>
                                <span id="metric-recall" class="text-white text-xs sm:text-sm font-bold">{{ v1_metrics.recall }}</span>
                            </div>
                            <div class="p-2 sm:p-3 rounded-xl bg-background-dark border border-border-dark flex flex-col gap-1">
                                <p class="text-[#9da6b9] text-[8px] font-bold uppercase tracking-tight">F1-Score</p>
                                <span id="metric-f1-score" class="text-white text-xs sm:text-sm font-bold">{{ v1_metrics.f1_score }}</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="flex flex-col gap-3 sm:gap-4">
                    <p class="text-white text-xs font-bold uppercase tracking-widest mb-1 sm:mb-2 opacity-50">System Info</p>
                    <div class="space-y-2">
                        <div class="flex justify-between items-center text-xs">
                            <span class="text-[#9da6b9]">Status</span>
                            <span id="metric-status" class="text-accent-green font-medium">Pre-trained</span>
                        </div>
                        <div class="flex justify-between items-center text-xs">
                            <span class="text-[#9da6b9]">Architecture</span>
                            <span id="metric-type" class="text-white font-medium">{{ v1_metrics.type }}</span>
                        </div>
                        <div class="flex justify-between items-center text-xs">
                            <span class="text-[#9da6b9]">Loss Function</span>
                            <span id="metric-loss" class="text-white font-medium">{{ v1_metrics.loss }}</span>
                        </div>
                        <div class="flex justify-between items-center text-xs">
                            <span class="text-[#9da6b9]">Loss Value</span>
                            <span id="metric-loss-value" class="text-accent-green font-mono font-bold">{{ v1_metrics.loss_value }}</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pt-4 sm:pt-6 border-t border-border-dark">
                <p class="text-[10px] text-[#475569] text-center">Â© 2026 Captcha-Recognition Project</p>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="flex-1 flex flex-col bg-background-dark overflow-y-auto">
            <!-- Page Heading -->
            <div class="flex flex-wrap justify-between items-center gap-2 sm:gap-3 p-4 sm:p-6 md:p-8 border-b border-border-dark/50">
                <div class="flex flex-col gap-1">
                    <p class="text-white text-xl sm:text-2xl md:text-3xl font-black leading-tight tracking-tight">AI ReCaptcha Solver</p>
                    <p id="feed-description" class="text-[#9da6b9] text-xs sm:text-sm font-normal">Native CRNN+CTC Simulation Feed</p>
                </div>
                <div class="flex gap-2 sm:gap-3">
                    <span class="px-2 sm:px-3 py-1 sm:py-1.5 rounded-lg bg-surface-dark border border-border-dark text-accent-green text-[10px] sm:text-xs font-mono" id="main-status">READY</span>
                </div>
            </div>

            <div class="p-4 sm:p-6 md:p-8 space-y-4 sm:space-y-6 md:space-y-8">
                <!-- Main Layout Split -->
                <div class="grid grid-cols-1 lg:grid-cols-12 gap-4 sm:gap-6 md:gap-8">
                    <!-- Challenge Feed -->
                    <div class="lg:col-span-7 flex flex-col gap-4 sm:gap-6">
                        <!-- Tab System -->
                        <div class="flex gap-1 sm:gap-2 p-1 bg-surface-dark rounded-lg border border-border-dark w-full sm:w-fit">
                            <button id="tab-v1" class="flex-1 sm:flex-none px-3 sm:px-4 py-2 rounded-md bg-primary text-white text-[10px] sm:text-xs font-bold transition-all touch-active no-select">v1: Text Captcha</button>
                            <button id="tab-v2" class="flex-1 sm:flex-none px-3 sm:px-4 py-2 rounded-md text-[#9da6b9] text-[10px] sm:text-xs font-bold hover:text-white transition-all touch-active no-select">v2: Image Select</button>
                        </div>

                        <div class="flex items-center justify-between">
                            <h2 class="text-white text-base sm:text-lg md:text-xl font-bold tracking-tight flex items-center gap-2">
                                <span class="relative flex h-2 w-2">
                                    <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-primary opacity-75"></span>
                                    <span class="relative inline-flex rounded-full h-2 w-2 bg-primary"></span>
                                </span>
                                Active Challenge
                            </h2>
                            <button id="refresh-challenge" class="text-[10px] sm:text-xs font-mono text-primary hover:text-white transition-colors flex items-center gap-1 touch-active min-h-[44px] px-2">
                                <span class="material-symbols-outlined text-sm">refresh</span> <span class="hidden xs:inline">REGENERATE</span>
                            </button>
                        </div>

                        <!-- v1: Text Captcha Container -->
                        <div id="v1-container" class="relative bg-surface-dark rounded-xl border border-border-dark shadow-inner overflow-hidden min-h-[100px] sm:min-h-[140px] flex items-center justify-center p-3 sm:p-4 group">
                            <div class="absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-primary/10 via-transparent to-transparent"></div>
                            <img id="challenge-img" src="" class="h-12 sm:h-16 w-auto object-contain transition-all duration-500 group-hover:scale-110 drop-shadow-[0_0_10px_rgba(19,91,236,0.3)] z-10" alt="Challenge" />
                            <div id="v1-scanner" class="scanner-line z-20"></div>
                        </div>

                        <!-- v2: Image Select Container -->
                        <div id="v2-container" class="hidden flex flex-col gap-3 sm:gap-4 w-full max-w-sm mx-auto">
                            <div class="bg-primary p-3 sm:p-4 rounded-lg flex flex-col gap-1 shadow-lg shadow-primary/20">
                                <p class="text-[9px] sm:text-[10px] font-bold uppercase tracking-widest opacity-80">Select all images with</p>
                                <h3 id="v2-target-name" class="text-xl sm:text-2xl font-black uppercase tracking-tight">---</h3>
                            </div>
                            <div id="v2-grid" class="grid grid-cols-3 gap-1 sm:gap-2 bg-surface-dark p-1.5 sm:p-2 rounded-xl border border-border-dark relative">
                                <!-- Grid items will be injected here -->
                                <div id="v2-scanner" class="scanner-line z-20"></div>
                            </div>
                        </div>

                        <!-- Solver Controls -->
                        <div class="bg-surface-dark border border-border-dark rounded-xl p-4 sm:p-6 space-y-3 sm:space-y-4">
                            <div id="v1-input-group" class="space-y-2">
                                <div class="flex justify-between items-end">
                                    <label class="text-[9px] sm:text-[10px] font-bold text-[#9da6b9] uppercase tracking-widest">Input Buffer</label>
                                    <span id="solver-status" class="text-[9px] sm:text-[10px] text-accent-green font-mono">IDLE</span>
                                </div>
                                <input type="text" id="captcha-solve-input" class="w-full bg-background-dark border border-border-dark rounded-lg px-3 sm:px-4 py-3 sm:py-4 text-white text-2xl sm:text-3xl md:text-4xl font-black tracking-[0.2em] sm:tracking-[0.3em] focus:ring-2 focus:ring-primary focus:border-transparent placeholder:text-border-dark" placeholder="-----" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
                            </div>

                            <div class="flex flex-col sm:flex-row gap-2 sm:gap-3">
                                <button id="btn-auto-solve" class="flex-1 flex items-center justify-center gap-2 bg-primary text-white px-4 sm:px-6 py-3 sm:py-4 rounded-lg text-xs sm:text-sm font-bold hover:brightness-110 transition-all shadow-lg shadow-primary/20 touch-active min-h-[48px]">
                                    <span class="material-symbols-outlined text-lg sm:text-xl">psychology</span>
                                    AI AUTO-SOLVE
                                </button>
                                <button id="btn-verify-solve" class="flex-1 flex items-center justify-center gap-2 bg-accent-green text-black px-4 sm:px-6 py-3 sm:py-4 rounded-lg text-xs sm:text-sm font-bold hover:brightness-110 transition-all shadow-lg shadow-accent-green/20 touch-active min-h-[48px]">
                                    <span class="material-symbols-outlined text-lg sm:text-xl">verified</span>
                                    VERIFY & SUBMIT
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Log Terminal -->
                    <div class="lg:col-span-5 flex flex-col gap-3 sm:gap-4">
                        <div class="flex items-center justify-between">
                            <h2 class="text-white text-base sm:text-lg md:text-xl font-bold tracking-tight">System Terminal</h2>
                            <button id="clear-terminal" class="text-[10px] font-bold text-[#9da6b9] uppercase hover:text-white transition-colors touch-active min-h-[44px] px-2">Clear</button>
                        </div>
                        <div class="bg-background-dark border border-border-dark rounded-xl overflow-hidden flex flex-col">
                            <div class="bg-surface-dark px-3 sm:px-4 py-2 border-b border-border-dark flex items-center justify-between">
                                <div class="flex gap-1.5">
                                    <div class="w-2 sm:w-2.5 h-2 sm:h-2.5 rounded-full bg-red-500/50"></div>
                                    <div class="w-2 sm:w-2.5 h-2 sm:h-2.5 rounded-full bg-yellow-500/50"></div>
                                    <div class="w-2 sm:w-2.5 h-2 sm:h-2.5 rounded-full bg-green-500/50"></div>
                                </div>
                                <span class="text-[9px] sm:text-[10px] font-mono text-[#9da6b9] truncate ml-2">root@gotcha-ai: ~/logs</span>
                            </div>
                            <div id="terminal-content" class="h-[200px] sm:h-[300px] md:h-[400px] lg:h-[500px] xl:h-[650px] p-3 sm:p-4 font-mono text-[10px] sm:text-[11px] space-y-1.5 sm:space-y-2 overflow-y-auto terminal-scroll">
                                <p class="text-accent-green font-bold">>> Gotcha! AI System Started</p>
                                <p class="text-[#9da6b9]">>> Model Status: {{ status }}</p>
                                <p class="text-[#9da6b9]">>> Simulation Environment: READY</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Status Bar -->
    <footer class="bg-surface-dark border-t border-border-dark px-3 sm:px-6 py-2 flex items-center justify-between z-30 safe-bottom">
        <div class="flex items-center gap-3 sm:gap-6 text-[9px] sm:text-[10px] font-mono text-[#9da6b9]">
            <div class="flex items-center gap-1.5 sm:gap-2">
                <span class="w-1.5 sm:w-2 h-1.5 sm:h-2 rounded-full bg-accent-green shadow-[0_0_5px_#00ff41]"></span>
                <span class="hidden xs:inline">ENGINE:</span> ACTIVE
            </div>
            <div class="hidden md:flex items-center gap-2 border-l border-border-dark pl-6">
                <span class="material-symbols-outlined text-[12px]">memory</span>
                INFERENCE UNIT: GPU-0
            </div>
        </div>
        <div class="text-[9px] sm:text-[10px] font-mono text-primary font-bold">v2.0.4</div>
    </footer>

    <!-- Server-Side Data Injection -->
    <script>
        window.v1Metrics = JSON.parse('{{ v1_metrics | tojson | safe }}');
        window.v2Metrics = JSON.parse('{{ v2_metrics | tojson | safe }}');
        window.initialStatus = '{{ status | safe }}';
    </script>
    
    <!-- Application Script -->
    <script src="/static/js/app.js"></script>
</body>

</html>
